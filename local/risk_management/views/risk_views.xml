<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!--top level menu-->
    <menuitem id="main_menu_risk_management" name="Risks"/>

    <menuitem id="config_menu" name="Configuration" parent="main_menu_risk_management" sequence="100"
              groups="risk_management.group_process_manager"/>

    <menuitem id="risk_menu" name="Risks" parent="main_menu_risk_management" sequence="10"/>


    <!-- ============================= COMPANY ================================= -->

    <!-- BUSINESS PROCESS DATA-->
    <!-- actions-->
    <!-- views-->
    <record model="ir.ui.view" id="process_data_form">
        <field name="name">business_process_data.form</field>
        <field name="model">risk_management.business_process_data</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group col="6">
                        <group colspan="4" col="2">
                            <field name="name" placeholder="Name"/>
                        </group>
                        <group colspan="2" col="2">
                            <field name="is_customer_voice"/>
                        </group>
                        <group colspan="4" col="2">
                            <field name="int_provider_id"
                                   attrs="{'invisible': [('ext_provider_cat_id', '!=', False)], 'required': [('ext_provider_cat_id', '=', False)],}"/>
                            <field name="ext_provider_cat_id"
                                   attrs="{'invisible': [('int_provider_id', '!=', False)], 'required': [('int_provider_id', '=', False)]}"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record model="ir.ui.view" id="process_output_data_list">
        <field name="name">process_data.tree</field>
        <field name="model">risk_management.business_process_data</field>
        <field name="arch" type="xml">
            <tree editable="bottom">
                <field name="name"/>
                <field name="is_customer_voice"/>
                <field name="consumer_ids" readonly="1" widget="many2many_tags"/>
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="process_data_list">
        <field name="name">process_data.tree</field>
        <field name="model">risk_management.business_process_data</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name" context="{'form_view_ref':'risk_management.process_data_form'}"/>
                <field name="is_customer_voice"/>
            </tree>
        </field>
    </record>
    <record model="ir.ui.view" id="process_data_search">
        <field name="name">process_data.search</field>
        <field name="model">risk_management.business_process_data</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="int_provider_id" string="Internal"/>
                <field name="ext_provider_cat_id" string="External"/>
                <filter name="int_provider" string="Internal" domain="[('int_provider_id', '!=', False)]"/>
                <filter name="ext_provider" string="External" domain="[('ext_provider_cat_id', '!=', False)]"/>
                <filter name="client_voice" string="Customer Voice" domain="[('is_customer_voice', '=', True)]"/>
            </search>
        </field>
    </record>

    <!-- BUSINESS PROCESS TASK-->

    <!-- views-->
    <record model="ir.ui.view" id="process_task_all">
        <field name="name">process_task.tree</field>
        <field name="model">risk_management.business_process.task</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="owner_id"/>
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="process_task_search">
        <field name="name">process_task.search</field>
        <field name="model">risk_management.business_process.task</field>
        <field name="arch" type="xml">
            <search>
                <field name="name" string="Tasks"/>
                <field name="owner_id"/>
                <field name="description"/>
                <field name="process_id"/>
                <filter name="my_tasks" string="My tasks"
                        domain="['|', ('owner_id', '=', uid), ('process_id.responsible_id', '=', uid)]"/>
                <filter string="Unassigned" name="unassigned" domain="[('owner_id', '=', False)]"/>
                <!-- TODO: add `group_by`-->
            </search>
        </field>
    </record>

    <!-- actions-->
    <record model="ir.actions.act_window" id="act_business_process_2_process_task_all">
        <field name="name">Tasks</field>
        <field name="res_model">risk_management.business_process.task</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{
            'default_process_id': active_id,
            'search_default_process_id': [active_id],
            }
        </field>
        <field name="search_view_id" ref="process_task_search"/>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Here, you can create new tasks
            </p>
        </field>
    </record>

    <!-- BUSINESS PROCESS METHOD-->
    <!-- views-->
    <record model="ir.ui.view" id="process_method_all">
        <field name="name">process_method.tree</field>
        <field name="model">risk_management.business_process.method</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="process_method_search">
        <field name="name">process_method.search</field>
        <field name="model">risk_management.business_process.method</field>
        <field name="arch" type="xml">
            <search>
                <field name="name" string="Methods"/>
                <field name="output_ref_id"/>
                <field name="process_id" string="Process"/>
                <field name="author_name"/>
                <filter name="my_methods" string="My Methods" domain="[('process_id.responsible_id', '=', uid)]"/>
                <!-- TODO: add `group_by`-->
            </search>
        </field>
    </record>

    <record model="ir.ui.view" id="process_method_form">
        <field name="name">process_method.form</field>
        <field name="model">risk_management.business_process.method</field>
        <field name="arch" type="xml">
            <form string="Method">
                <sheet>
                    <div class="oe_left oe_title">
                        <label for="name" class="oe_edit_only"/>
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    <group>
                        <field name="process_id"
                               context="{'form_view_ref': 'risk_management.business_process_form_view'}"/>
                        <field name="output_ref_id"/>
                        <field name="author_name" string="Origin"/>
                    </group>
                    <notebook>
                        <page name="content_page" string="Details">
                            <field name="content"/>
                            <div class="oe_clear"/>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- actions-->
    <record model="ir.actions.act_window" id="act_business_process_2_process_method_all">
        <field name="name">Methods</field>
        <field name="res_model">risk_management.business_process.method</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{'default_process_id': active_id, 'search_default_process_id': [active_id],
            }
        </field>
        <field name="search_view_id" ref="process_method_search"/>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Here, you can create new process methods
            </p>
        </field>
    </record>

    <record model="ir.actions.act_window.view" id="action_process_method_all_list">
        <field name="act_window_id" ref="act_business_process_2_process_method_all"/>
        <field name="view_id" ref="process_method_all"/>
        <field name="view_mode">tree</field>
        <field name="sequence">10</field>
    </record>

    <record model="ir.actions.act_window.view" id="action_process_method_all_form">
        <field name="act_window_id" ref="act_business_process_2_process_method_all"/>
        <field name="view_id" ref="process_method_form"/>
        <field name="view_mode">form</field>
        <field name="sequence">20</field>
    </record>

    <!-- BUSINESS RISKS -->

    <!-- Evaluation -->
    <record model="ir.actions.act_window" id="act_set_business_risk_threshold_wizard">
        <field name="name">Set Business Risk Threshold</field>
        <field name="res_model">risk_management.business_risk.set_threshold_wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">
            {'default_risk_id': active_id, 'risk_model': 'risk_management.business_risk'}
        </field>
    </record>

    <record model="ir.actions.act_window" id="act_eval_business_risk_wizard">
        <field name="name">Business Risk Evaluation</field>
        <field name="res_model">risk_management.business_risk.eval_wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">
            {'default_risk_id': active_id, 'risk_model': 'risk_management.business_risk'}
        </field>
    </record>

    <record model="ir.actions.act_window" id="act_edit_risk_info_help">
        <field name="name">Risk Treatment guidelines</field>
        <field name="res_model">risk_management.risk.help_wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

    <record model="ir.ui.view" id="view_business_risk_threshold_wizard">
        <field name="name">Business Risk Threshold Wizard Form</field>
        <field name="model">risk_management.business_risk.set_threshold_wizard</field>
        <field name="arch" type="xml">
            <form string="Set risk Threshold">
                <sheet>
                    <group name="info">
                        <field name="risk_id" invisible="1"/>
                    </group>
                    <group string="Criteria scores">
                        <field name="detectability"/>
                        <field name="occurrence"/>
                        <field name="severity"/>
                    </group>
                    <notebook>
                        <page name="comment_page" string="Comment">
                            <field name="comment"/>
                            <div class="oe_clear"/>
                        </page>
                    </notebook>
                </sheet>
                <footer>
                    <button name="set_value"
                            string="Set"
                            class="btn-primary"
                            type="object"
                    />
                    <button string="Cancel"
                            class="btn-default"
                            special="cancel"
                    />
                </footer>
            </form>
        </field>
    </record>

    <record model="ir.ui.view" id="view_business_evaluation_wizard">
        <field name="name">Business Risk Evaluation Wizard Form</field>
        <field name="model">risk_management.business_risk.eval_wizard</field>
        <field name="arch" type="xml">
            <form string="Risk Evaluation">
                <sheet>
                    <group name="info">
                        <field name="risk_id" invisible="1"/>
                        <label for="write_date" class="oe_read_only"/>
                        <field name="write_date" class="oe_read_only" nolabel="1"/>
                    </group>
                    <group string="Criteria scores">
                        <group>
                            <field name="detectability"/>
                            <field name="occurrence"/>
                            <field name="severity"/>
                        </group>
                        <group>
                            <field name="review_date"/>
                        </group>
                    </group>
                    <notebook>
                        <page name="comment_page" string="Comment">
                            <field name="comment"/>
                            <div class="oe_clear"/>
                        </page>
                    </notebook>
                </sheet>
                <footer>
                    <button name="set_value"
                            string="Save"
                            class="btn-primary"
                            type="object"
                    />
                    <button string="Cancel"
                            class="btn-default"
                            special="cancel"
                    />
                </footer>
            </form>
        </field>
    </record>

    <record model="ir.ui.view" id="view_risk_help_wizard">
        <field name="name">Risk Help Wizard Form</field>
        <field name="model">risk_management.risk.help_wizard</field>
        <field name="arch" type="xml">
            <form string="Edit Help">
                <sheet>
                    <field name="risk_info_id" invisible="1"/>
                    <notebook>
                        <page string="Steering / Monitoring">
                            <field name="risk_info_control"/>
                        </page>
                        <page string="Action / Hedging policy">
                            <field name="risk_info_action"/>
                        </page>
                    </notebook>
                </sheet>
                <footer>
                    <button name="write_changes"
                            string="Save"
                            class="btn-primary"
                            type="object"
                    />
                    <button string="Cancel"
                            class="btn-default"
                            special="cancel"
                    />
                </footer>
            </form>

        </field>
    </record>

    <record id="view_business_risk_search" model="ir.ui.view">
        <field name="name">business_risk.search</field>
        <field name="model">risk_management.business_risk</field>
        <field name="arch" type="xml">
            <search>
                <field name="risk_info_id"/>
                <field name="process_id"/>
                <field name="risk_info_description"/>
                <field name="risk_info_cause"/>
                <field name="risk_info_consequence"/>
                <filter name="threats" string="Threat" domain="[('risk_type', '=', 'T')]"/>
                <filter name="opportunities" string="Opportunities" domain="[('risk_type', '=', 'O')]"/>
                <filter name="active" string="Active" domain="[('active', '=', 1)]"/>
                <filter name="inactive" string="Inactive" domain="[('active', '=', 0)]"/>
                <group expand="0" string="Group By">
                    <filter string="Type" name="Type" context="{'group_by':'risk_type'}"/>
                    <filter string="Process" name="Process" context="{'group_by': 'process_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="act_record_risk_wizard" model="ir.actions.act_window">
        <field name="name">New Business Risk</field>
        <field name="res_model">risk_management.business_risk.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

    <record model="ir.actions.act_window" id="act_business_risk_register">
        <field name="name">Risk Register</field>
        <field name="res_model">risk_management.business_risk</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_business_risk_search"/>
        <field name="context" eval="{'active_test': False}"/>
        <field name="help" type="html">
            <p class="oe_view_nocontent">
                There is no risk in this risk register at the moment.
                <br/>
                <a type="action" name="%(risk_management.act_record_risk_wizard)d">Report a risk</a>
            </p>
        </field>
    </record>

    <record id="view_business_risk_list" model="ir.ui.view">
        <field name="name">business_risk.list</field>
        <field name="model">risk_management.business_risk</field>
        <field name="arch" type="xml">
            <tree create="false" decoration-muted="active==False"
                  decoration-info="active==True and status=='U'" decoration-danger="status=='N'"
                  decoration-bf="status=='N'" decoration-success="status=='A'"
            >
                <field name="risk_info_id"/>
                <field name="report_date"/>
                <field name="status" invisible="1"/>
                <field name="active" invisible="1"/>
                <field name="process_id"/>
                <field name="review_date"/>
                <field name="threshold_value"/>
                <field name="latest_level_value" attrs="{'invisible': [('latest_level_value', '=', 0)] }"/>
            </tree>
        </field>
    </record>

    <record id="view_business_risk_edit" model="ir.ui.view">
        <field name="name">business_risk.edit_form</field>
        <field name="model">risk_management.business_risk</field>
        <field name="arch" type="xml">
            <form create="false">
                <header>
                    <button name="assign_to_me" string="Assign to Me" type="object" class="oe_highlight"
                            attrs="{'invisible' : [('active', '=', 1),('owner', '!=', False)]}"/>
                    <field name="mgt_stage" widget="statusbar"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <div class="oe_button_box" name="treatment_button">
                            <button name="get_treatment"
                                    type="object"
                                    class="btb-primary oe_stat_button"
                                    icon="fa-tasks"
                                    attrs="{'invisible': ['|', ('active', '=', 0), ('latest_level_value', '=', 0)]}"
                            >
                                <field string="Treatment tasks" name="treatment_task_count" widget="statinfo"/>
                            </button>
                        </div>
                        <field name="status" readonly="True"/>
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    <group>
                        <field name="risk_info_id" style="width:400px" readonly="1"/>
                        <field name="process_id" readonly="1"/>
                    </group>
                    <group col="12">
                        <group colspan="6" col="2">

                            <field name="risk_info_category"/>
                            <field name="risk_info_subcategory"/>
                            <label for="threshold_value"/>
                            <button name="%(risk_management.act_set_business_risk_threshold_wizard)d"
                                    type="action"
                                    class="btn-primary oe_link"
                            >
                                <field name="threshold_value" string="Risk Threshold" help="Change risk threshold"/>
                            </button>
                            <label for="latest_level_value"/>
                            <button name="%(risk_management.act_eval_business_risk_wizard)d"
                                    type="action"
                                    class="btn-primary oe_link"
                            >
                                <field name="latest_level_value" string="Risk Level"/>
                            </button>
                        </group>
                        <group colspan="6" col="2">
                            <field name="active" invisible="1"/>
                            <field name="risk_type"/>
                            <label for="reported_by" class="oe_read_only"/>
                            <field name="reported_by" class="oe_read_only" nolabel="1"/>
                            <label for="report_date" class="oe_read_only"/>
                            <field name="report_date" class="oe_read_only" nolabel="1"/>
                            <label for="review_date" class="oe_edit_only"/>
                            <field name="review_date" class="oe_edit_only" nolabel="1"/>
                            <field name="owner"/>
                        </group>
                    </group>
                    <notebook>
                        <page name="info_page" string="Info">

                            <group>
                                <field name="risk_info_description"/>


                                <field name="risk_info_cause"/>


                                <field name="risk_info_consequence"/>
                            </group>
                        </page>
                        <page name="help_page" string="Treatment guides">
                            <group>
                                <button
                                        name="%(risk_management.act_edit_risk_info_help)d"
                                        type="action"
                                        string="Edit..."
                                        class="btn-primary oe_right oe_link"
                                        context="{'default_risk_info_id': risk_info_id}"
                                >
                                </button>
                            </group>
                            <group>
                                <field name="risk_info_control"/>
                            </group>
                            <group>
                                <field name="risk_info_action"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="view_business_risk_wizard" model="ir.ui.view">
        <field name="name">Risk Report Wizard Form</field>
        <field name="model">risk_management.business_risk.wizard</field>
        <field name="arch" type="xml">
            <form string="Report a risk">
                <sheet>
                    <group string="Ref.">
                        <group>
                            <field name="process_id"/>
                            <field name="risk_type"/>
                        </group>
                        <group>
                            <field name="reported_by"/>
                            <field name="report_date"/>
                        </group>
                    </group>
                    <group string="Details">
                        <field name="risk_info_id" string="Risk Name" class="oe_no_button"/>
                        <field name="risk_info_description" attrs="{'invisible': [('risk_info_id', '=', False)]}"/>
                        <field name="risk_info_cause" attrs="{'invisible': [('risk_info_id', '=', False)]}"/>
                        <field name="risk_info_consequence" attrs="{'invisible': [('risk_info_id', '=', False)]}"/>
                    </group>
                </sheet>
                <footer>
                    <button name="record_risk"
                            string="Submit"
                            class="btn-primary"
                            type="object"
                    />
                    <button string="Cancel"
                            class="btn-default"
                            special="cancel"
                    />
                </footer>
            </form>
        </field>
    </record>


    <menuitem id="menu_risk_register" name="Risk Register" parent="risk_menu" action="act_business_risk_register"/>
    <menuitem id="menu_wizard_report_business_risk" parent="risk_menu" action="act_record_risk_wizard" sequence="30"/>

    <!-- BUSINESS PROCESS-->
    <!-- actions-->
    <record model="ir.actions.act_window" id="business_process_list_action">
        <field name="name">Processes</field>
        <field name="res_model">risk_management.business_process</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">Create your first Process!</p>
        </field>
    </record>

    <!-- views-->
    <record model="ir.ui.view" id="business_process_kanban_view">
        <field name="name">process.kanban</field>
        <field name="model">risk_management.business_process</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile" default_group_by="process_type">
                <field name="responsible_id" string="Process Manager"/>
                <field name="process_type"/>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_content oe_kanban_global_click o_kanban_get_form">
                            <div class="row">
                                <div class="col-xs-12">
                                    <strong>
                                        <field name="name" string="Process Name"/>
                                    </strong>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-8">
                                    <field name="business_id" string="Company"/>
                                </div>
                                <div class="col-xs-4">
                                    <div class="oe_kanban_bottom_right">
                                        <img t-att-src="kanban_image('res.users', 'image_small', record.responsible_id.raw_value)"
                                             t-att-title="record.responsible_id.value" width="24" height="24"
                                             class="oe_kanban_avatar pull-right"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>
    <record model="ir.ui.view" id="business_process_form_view">
        <field name="name">business_process.form</field>
        <field name="model">risk_management.business_process</field>
        <field name="arch" type="xml">
            <form string="Process">
                <header>
                    <button name="%(risk_management.act_record_risk_wizard)d"
                            type="action"
                            string="New risk"
                            context="{'default_process_id': active_id}"
                            class="btn-danger"
                    >

                    </button>
                </header>
                <sheet string="Process">
                    <div class="oe_left oe_title">
                        <label for="name" class="oe_edit_only"/>
                        <h1>
                            <field name="name" placeholder="Process name"/>
                        </h1>
                    </div>
                    <div class="oe_right oe_button_box" name="buttons">
                        <button name="%(risk_management.act_business_process_2_process_method_all)d"
                                type="action"
                                class="oe_stat_button"
                                icon="fa-files-o">
                            <field string="Procedures" name="method_count" widget="statinfo"/>
                        </button>
                        <button name="%(risk_management.act_business_process_2_process_task_all)d"
                                type="action"
                                class="oe_stat_button"
                                icon="fa-tasks">
                            <field string="Task" name="task_count" widget="statinfo"/>
                        </button>
                        <button name="%(risk_management.act_business_risk_register)d"
                                type="action"
                                class="oe_stat_button"
                                icon="fa-exclamation-circle"
                                context="{'default_process_id': active_id, 'search_default_process_id': [active_id], 'search_default_active': 1}"
                        >
                            <field name="risk_count" string="Risk reports"/>
                        </button>
                    </div>
                    <group>
                        <field name="business_id" invisible="1"/> <!-- FIXME multi-company -->
                        <field name="process_type"/>
                        <field name="responsible_id"/>
                        <field name="module" class="oe_no_link"/>
                    </group>
                    <notebook>
                        <page name="description_page" string="Description">
                            <field name="description" type="html"/>
                            <div class="oe_clear"/>
                        </page>
                        <page string="Input" name="input_page">
                            <field name="input_data_ids"
                                   context="{'tree_view_ref': 'risk_management.process_data_list'}"/>
                        </page>
                        <page string="Output" name="output_page">
                            <field name="output_data_ids"
                                   context="{ 'tree_view_ref':'risk_management.process_output_data_list', 'default_int_provider_id': active_id}"/>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record model="ir.ui.view" id="business_process_list_view">
        <field name="name">process.tree</field>
        <field name="model">risk_management.business_process</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="responsible_id"/>
                <field name="module"/>
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="business_process_search_view">
        <field name="name">process.search</field>
        <field name="model">risk_management.business_process</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="description"/>
                <field name="module"/>
                <filter name="Management" string="Management" domain="[('process_type', '=', 'M')]"/>
                <filter name="Operation" string="Operations" domain="[('process_type', '=', 'O')]"/>
                <filter name="Support" string="Support" domain="[('process_type', '=', 'S')]"/>
                <group expand="0" string="Group By">
                    <filter string="Type" name="Type" context="{'group_by':'process_type'}"/>
                    <filter string="Module" name="Module" context="{'group_by':'module'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- menu -->
    <menuitem id="menu_business_process_list" name="Processes" parent="config_menu"
              action="business_process_list_action" sequence="30"/>


    <!-- =============================  PROJECT ================================= -->

    <!-- PROJECT PROCESS DATA-->
    <!-- views-->
    <record model="ir.ui.view" id="project_process_data_form">
        <field name="name">project_process_data.form</field>
        <field name="model">risk_management.project_process_data</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group col="6">
                        <group colspan="4" col="2">
                            <field name="name" placeholder="Name"/>
                        </group>
                        <group colspan="2" col="2">
                            <field name="is_customer_voice"/>
                        </group>
                        <group colspan="4" col="2">
                            <field name="int_provider_id"
                                   attrs="{'invisible': [('ext_provider_cat_id', '!=', False)], 'required': [('ext_provider_cat_id', '=', False)],}"/>
                            <field name="ext_provider_cat_id"
                                   attrs="{'invisible': [('int_provider_id', '!=', False)], 'required': [('int_provider_id', '=', False)]}"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record model="ir.ui.view" id="project_process_output_data_list">
        <field name="name">project_process_data.tree</field>
        <field name="model">risk_management.project_process_data</field>
        <field name="arch" type="xml">
            <tree editable="bottom">
                <field name="name"/>
                <field name="is_customer_voice"/>
                <field name="consumer_ids" readonly="1" widget="many2many_tags"/>
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="project_process_data_list">
        <field name="name">project_process_data2.tree</field>
        <field name="model">risk_management.project_process_data</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name" context="{'form_view_ref':'risk_management.project_process_data_form'}"/>
                <field name="is_customer_voice"/>
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="project_process_data_search">
        <field name="name">project_process_data.search</field>
        <field name="model">risk_management.project_process_data</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="int_provider_id" string="Internal"/>
                <field name="ext_provider_cat_id" string="External"/>
                <filter name="int_provider" string="Internal" domain="[('int_provider_id', '!=', False)]"/>
                <filter name="ext_provider" string="External" domain="[('ext_provider_cat_id', '!=', False)]"/>
                <filter name="client_voice" string="Customer Voice" domain="[('is_customer_voice', '=', True)]"/>
            </search>
        </field>
    </record>

    <!-- PROJECT PROCESS METHOD-->
    <!-- views-->
    <record model="ir.ui.view" id="project_process_method_all">
        <field name="name">project_process_method.tree</field>
        <field name="model">risk_management.project_process.method</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="project_process_method_search">
        <field name="name">project_process_method.search</field>
        <field name="model">risk_management.project_process.method</field>
        <field name="arch" type="xml">
            <search>
                <field name="name" string="Methods"/>
                <field name="output_ref_id"/>
                <field name="process_id" string="Process"/>
                <field name="author_name"/>
                <filter name="my_methods" string="My Methods" domain="[('process_id.responsible_id', '=', uid)]"/>
                <!-- TODO: add `group_by`-->
            </search>
        </field>
    </record>

    <record model="ir.ui.view" id="project_process_method_form">
        <field name="name">project_process_method.form</field>
        <field name="model">risk_management.project_process.method</field>
        <field name="arch" type="xml">
            <form string="Method">
                <sheet>
                    <div class="oe_left oe_title">
                        <label for="name" class="oe_edit_only"/>
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    <group>
                        <field name="process_id" context="{'form_view_ref': 'risk_management.project_process_form'}"/>
                        <field name="output_ref_id"/>
                        <field name="author_name" string="Origin"/>
                    </group>
                    <notebook>
                        <page name="content_page" string="Details">
                            <field name="content"/>
                            <div class="oe_clear"/>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- actions-->
    <record model="ir.actions.act_window" id="act_project_process_2_process_method_all">
        <field name="name">Methods</field>
        <field name="res_model">risk_management.project_process.method</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{'default_process_id': active_id, 'search_default_process_id': [active_id],
            }
        </field>
        <field name="search_view_id" ref="project_process_method_search"/>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Here, you can create new process methods
            </p>
        </field>
    </record>

    <record model="ir.actions.act_window.view" id="action_project_process_method_all_form">
        <field name="act_window_id" ref="act_project_process_2_process_method_all"/>
        <field name="view_id" ref="project_process_method_form"/>
        <field name="view_mode">form</field>
        <field name="sequence">20</field>
    </record>

    <record model="ir.actions.act_window.view" id="action_project_process_method_all_list">
        <field name="act_window_id" ref="act_project_process_2_process_method_all"/>
        <field name="view_id" ref="project_process_method_all"/>
        <field name="view_mode">tree</field>
        <field name="sequence">10</field>
    </record>

    <!-- PROJECT RISK-->

    <record model="ir.actions.act_window" id="act_set_project_risk_threshold_wizard">
        <field name="name">Set Project Risk Threshold</field>
        <field name="res_model">risk_management.project_risk.set_threshold_wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">
            {'default_risk_id': active_id, 'risk_model': 'risk_management.project_risk'}
        </field>
    </record>

    <record model="ir.actions.act_window" id="act_eval_project_risk_wizard">
        <field name="name">Project Risk Evaluation</field>
        <field name="res_model">risk_management.project_risk.eval_wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">
            {'default_risk_id': active_id, 'risk_model': 'risk_management.project_risk'}
        </field>
    </record>

    <record model="ir.ui.view" id="view_project_risk_threshold_wizard2">
        <field name="name">Project Risk Threshold Wizard Form</field>
        <field name="model">risk_management.project_risk.set_threshold_wizard</field>
        <field name="arch" type="xml">
            <form string="Set risk Threshold">
                <sheet>
                    <group name="info">
                        <field name="risk_id" invisible="1"/>
                    </group>
                    <group string="Criteria scores">
                        <field name="detectability"/>
                        <field name="occurrence"/>
                        <field name="severity"/>
                    </group>
                    <notebook>
                        <page name="comment_page" string="Comment">
                            <field name="comment"/>
                            <div class="oe_clear"/>
                        </page>
                    </notebook>
                </sheet>
                <footer>
                    <button name="set_value"
                            string="Set Threshold"
                            class="btn-primary"
                            type="object"
                    />
                    <button string="Cancel"
                            class="btn-default"
                            special="cancel"
                    />
                </footer>
            </form>
        </field>
    </record>

    <record model="ir.ui.view" id="view_project_evaluation_wizard2">
        <field name="name">Project Risk Evaluation Wizard Form</field>
        <field name="model">risk_management.project_risk.eval_wizard</field>
        <field name="arch" type="xml">
            <form string="Risk Evaluation">
                <sheet>
                    <group name="info">
                        <field name="risk_id" invisible="1"/>
                        <label for="write_date" class="oe_read_only"/>
                        <field name="write_date" class="oe_read_only" nolabel="1"/>
                    </group>
                    <group string="Criteria scores">
                        <group>
                            <field name="detectability"/>
                            <field name="occurrence"/>
                            <field name="severity"/>
                        </group>
                        <group>
                            <field name="review_date"/>
                        </group>
                    </group>
                    <notebook>
                        <page name="comment_page" string="Comment">
                            <field name="comment"/>
                            <div class="oe_clear"/>
                        </page>
                    </notebook>
                </sheet>
                <footer>
                    <button name="set_value"
                            string="Save"
                            class="btn-primary"
                            type="object"
                    />
                    <button string="Cancel"
                            class="btn-default"
                            special="cancel"
                    />
                </footer>
            </form>
        </field>
    </record>

    <record id="view_project_risk_search" model="ir.ui.view">
        <field name="name">project_risk.search</field>
        <field name="model">risk_management.project_risk</field>
        <field name="inherit_id" ref="view_business_risk_search"/>
        <field name="arch" type="xml">
            <field name="process_id" position="after">
                <field name="project_id"/>
            </field>
            <xpath expr="//filter[@name='Process']" position="after">
                <filter string="Project" name="Project" context="{'group_by': 'project_id'}"/>
            </xpath>
        </field>
    </record>

    <record id="act_record_project_risk_wizard" model="ir.actions.act_window">
        <field name="name">New Project Risk</field>
        <field name="res_model">risk_management.project_risk.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

    <record id="view_project_risk_edit2" model="ir.ui.view">
        <field name="name">project_risk.edit_form</field>
        <field name="model">risk_management.project_risk</field>
        <field name="arch" type="xml">
            <form create="false">
                <header>
                    <button name="assign_to_me" string="Assign to Me" type="object" class="oe_highlight"
                            attrs="{'invisible' : [('active', '=', 1),('owner', '!=', False)]}"/>
                    <field name="mgt_stage" widget="statusbar"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <div class="oe_button_box" name="treatment_button">
                            <button name="action_add_treatment_task"
                                    type="object"
                                    class="btb-primary oe_stat_button"
                                    icon="fa-tasks"
                                    attrs="{'invisible': ['|', ('active', '=', 0), ('latest_level_value', '=', 0)]}"
                            >
                                <field string="Treatment tasks" name="treatment_task_count" widget="statinfo"/>
                            </button>
                        </div>
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    <group>
                        <field name="risk_info_id" readonly="1" style="width:400px"/>
                        <field name="project_id" readonly="1"/>
                        <field name="process_id" readonly="1"/>
                    </group>
                    <group col="12">
                        <group colspan="6" col="2">

                            <field name="risk_info_category"/>
                            <field name="risk_info_subcategory"/>
                            <label for="threshold_value"/>
                            <button name="%(risk_management.act_set_project_risk_threshold_wizard)d"
                                    type="action"
                                    class="btn-primary oe_link"
                            >
                                <field name="threshold_value" string="Risk Threshold" help="Change risk threshold"/>
                            </button>
                            <label for="latest_level_value"/>
                            <button name="%(risk_management.act_eval_project_risk_wizard)d"
                                    type="action"
                                    class="btn-primary oe_link"
                            >
                                <field name="latest_level_value" string="Risk Level"/>
                            </button>
                        </group>
                        <group colspan="6" col="2">
                            <field name="active" invisible="1"/>
                            <field name="risk_type"/>
                            <label for="reported_by" class="oe_read_only"/>
                            <field name="reported_by" class="oe_read_only" nolabel="1"/>
                            <label for="report_date" class="oe_read_only"/>
                            <field name="report_date" class="oe_read_only" nolabel="1"/>
                            <label for="review_date" class="oe_edit_only"/>
                            <field name="review_date" class="oe_edit_only" nolabel="1"/>
                            <field name="owner"/>
                        </group>
                    </group>
                    <notebook>
                        <page name="info_page" string="Info">

                            <group>
                                <field name="risk_info_description"/>


                                <field name="risk_info_cause"/>


                                <field name="risk_info_consequence"/>
                            </group>
                        </page>
                        <page name="help_page" string="Treatment guides">
                            <group>
                                <button
                                        name="%(risk_management.act_edit_risk_info_help)d"
                                        type="action"
                                        string="Edit..."
                                        class="btn-primary oe_right oe_link"
                                        context="{'default_risk_info_id': risk_info_id}"
                                >
                                </button>
                            </group>
                            <group>
                                <field name="risk_info_control"/>
                            </group>
                            <group>
                                <field name="risk_info_action"/>
                            </group>
                        </page>
                        <page name="comment_page" string="Comments">
                            <group>
                                <field name="comment"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record model="ir.actions.act_window" id="act_project_risk_reg">
        <field name="name">Risk Register</field>
        <field name="res_model">risk_management.project_risk</field>
        <field name="view_mode">tree,form</field>
        <field name="context" eval="{'active_test': False, 'form_view_ref': 'risk_management.view_project_risk_edit'}"/>
        <field name="search_view_id" ref="view_project_risk_search"/>
        <field name="help" type="html">
            <p class="oe_view_nocontent">
                There is no risk in this risk register at the moment.
                <br/>
                <a type="action" name="%(risk_management.act_record_project_risk_wizard)d">Report a risk</a>
            </p>
        </field>
    </record>

    <record id="view_project_risk_list" model="ir.ui.view">
        <field name="name">project_risk.list</field>
        <field name="model">risk_management.project_risk</field>
        <field name="arch" type="xml">
            <tree create="false" decoration-muted="active==False"
                  decoration-info="active==True and status=='U'" decoration-danger="status=='N'"
                  decoration-bf="status=='N'" decoration-success="status=='A'"
            >
                <field name="risk_info_id"/>
                <field name="report_date"/>
                <field name="status" invisible="1"/>
                <field name="active" invisible="1"/>
                <field name="project_id"/>
                <field name="process_id"/>
                <field name="review_date"/>
                <field name="threshold_value"/>
                <field name="latest_level_value" attrs="{'invisible': [('latest_level_value', '=', 0)] }"/>
            </tree>
        </field>
    </record>


    <record id="view_project_risk_wiz" model="ir.ui.view">
        <field name="name">Risk Report Wizard Form</field>
        <field name="model">risk_management.project_risk.wizard</field>
        <field name="arch" type="xml">
            <form string="Report a risk">
                <sheet>
                    <group string="Ref.">
                        <group>
                            <field name="project_id"/>
                            <field name="process_id"/>
                            <field name="risk_type"/>
                        </group>
                        <group>
                            <field name="reported_by"/>
                            <field name="report_date"/>
                        </group>
                    </group>
                    <group string="Details">
                        <field name="risk_info_id" string="Risk Name" class="oe_no_button"/>
                        <field name="risk_info_description" attrs="{'invisible': [('risk_info_id', '=', False)]}"/>
                        <field name="risk_info_cause" attrs="{'invisible': [('risk_info_id', '=', False)]}"/>
                        <field name="risk_info_consequence" attrs="{'invisible': [('risk_info_id', '=', False)]}"/>
                    </group>
                </sheet>
                <footer>
                    <button name="record_risk"
                            string="Submit"
                            class="btn-primary"
                            type="object"
                    />
                    <button string="Cancel"
                            class="btn-default"
                            special="cancel"
                    />
                </footer>
            </form>
        </field>
    </record>


    <menuitem name="Risks management" id="project_risk_management" parent="project.menu_main_pm" sequence="3"/>
    <menuitem name="Report a new risk" id="menu_wizard_report_project_risk" parent="project_risk_management"
              action="act_record_project_risk_wizard" sequence="20"/>
    <menuitem name="Risk Register" id="menu_project_risk_register" parent="project_risk_management"
              action="act_project_risk_reg" sequence="10"/>

    <!-- PROJECT PROCESS-->
    <!--views-->
    <record model="ir.ui.view" id="project_process_search">
        <field name="name">project_process.search</field>
        <field name="model">risk_management.project_process</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="description"/>
                <field name="project_id"/>
                <filter name="management" string="Management" domain="[('process_type', '=', 'M')]"/>
                <filter name="operation" string="Operations" domain="[('process_type', '=', 'O')]"/>
                <filter name="support" string="Support" domain="[('process_type', '=', 'S')]"/>
                <filter name="my_processes" string="My processes"
                        domain="['|', ('project_id.user_id', '=', uid), ('responsible_id', '=', uid)]"/>
                <group expand="0" string="Group By">
                    <filter string="Type" name="Type" context="{'group_by':'process_type'}"/>
                    <filter string="project" name="project" context="{'group_by':'project_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <record model="ir.ui.view" id="project_process_kanban_view">
        <field name="name">project_process.kanban</field>
        <field name="model">risk_management.project_process</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile" default_group_by="process_type">
                <field name="responsible_id" string="Process Manager"/>
                <field name="process_type"/>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_content oe_kanban_global_click o_kanban_get_form">
                            <div class="row">
                                <div class="col-xs-12">
                                    <strong>
                                        <field name="name" string="Process Name"/>
                                    </strong>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-8">
                                    <field name="project_id" string="Project"/>
                                </div>
                                <div class="col-xs-4">
                                    <div class="oe_kanban_bottom_right">
                                        <img t-att-src="kanban_image('res.users', 'image_small', record.responsible_id.raw_value)"
                                             t-att-title="record.responsible_id.value" width="24" height="24"
                                             class="oe_kanban_avatar pull-right"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record model="ir.ui.view" id="project_process_form">
        <field name="model">risk_management.project_process</field>
        <field name="inherit_id" ref="business_process_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@name='buttons']/button[1]" position="replace">
                <button name="%(risk_management.act_project_process_2_process_method_all)d"
                        type="action"
                        class="oe_stat_button"
                        icon="fa-files-o">
                    <field string="Procedures" name="method_count" widget="statinfo"/>

                </button>
            </xpath>
            <xpath expr="//div[@name='buttons']/button[3]" position="replace">
                <button name="%(risk_management.act_project_risk_reg)d"
                        type="action"
                        class="oe_stat_button"
                        icon="fa-exclamation-circle"
                        context="{'default_process_id': active_id, 'search_default_process_id': [active_id], 'search_default_active': 1}"
                >
                    <field name="risk_count" string="Risk reports"/>
                </button>
            </xpath>
            <xpath expr="//div[@name='buttons']/button[2]" position="replace"/>
            <field name="business_id" position="replace">
                <field name="project_id"/>
            </field>
            <field name="module" position="replace"/>
            <field name="input_data_ids" position="attributes">
                <attribute name="context" eval="{'tree_view_ref': 'risk_management.project_process_data_list'}"/>
            </field>
            <field name="output_data_ids" position="replace">
                <field name="output_data_ids"
                       context="{ 'tree_view_ref':'risk_management.project_process_output_data_list', 'default_int_provider_id': active_id}"/>
            </field>
        </field>
    </record>

    <record model="ir.ui.view" id="project_process_all">
        <field name="name">project_process.tree</field>
        <field name="model">risk_management.project_process</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="responsible_id"/>
                <field name="project_id"/>
            </tree>
        </field>
    </record>
    <!-- project actions-->
    <record model="ir.actions.act_window" id="act_project_project_2_project_process_all">
        <field name="name">Processes</field>
        <field name="res_model">risk_management.project_process</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="context">
            {'default_project_id': active_id,
            'search_default_project_id': [active_id]}
        </field>
        <field name="view_ids" eval="[(5, 0, 0),
                                      (0, 0, {'view_mode': 'tree', 'view_id': ref('project_process_all')}),
                                      (0, 0, {'view_mode': 'form', 'view_id': ref('project_process_form')}),
                                      (0, 0, {'view_mode': 'kanban', 'view_id': ref('project_process_kanban_view')})]"
        />
        <field name="search_view_id" ref="project_process_search"/>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Here, you can create new process
            </p>
        </field>
    </record>

    <record model="ir.actions.act_window" id="act_project_process_list">
        <field name="name">Processes</field>
        <field name="res_model">risk_management.project_process</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="view_ids" eval="[(5, 0, 0),
                                      (0, 0, {'view_mode': 'tree', 'view_id': ref('project_process_all')}),
                                      (0, 0, {'view_mode': 'form', 'view_id': ref('project_process_form')}),
                                      (0, 0, {'view_mode': 'kanban', 'view_id': ref('project_process_kanban_view')})]"
        />
        <field name="context">
            {'search_default_my_processes':1}
        </field>
        <field name="search_view_id" ref="project_process_search"/>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Here, you can create new process
            </p>
        </field>
    </record>

    <!-- menu -->
    <menuitem id="menu_project_process_list" name="Processes" parent="project.menu_project_config"
              action="act_project_process_list" groups="project.group_project_manager" sequence="99"/>

    <!-- project form-->
    <record model="ir.ui.view" id="project_form">
        <field name="name">project.project.form</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="project.edit_project"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@name='button_box']/button[2]" position="after">
                <button class="oe_stat_button" type="action"
                        name="%(act_project_project_2_project_process_all)d" icon="fa-refresh">
                    <field string="Processes" name="process_count" widget="statinfo"/>
                </button>
                <button class="oe_stat_button" type="action"
                        name="%(risk_management.act_project_risk_reg)d"
                        icon="fa-exclamation-circle"
                        context="{'search_default_project_id': active_id}"
                >
                    <field string="Risks" name="risk_count" widget="statinfo"/>
                </button>
            </xpath>
        </field>
    </record>

    <!-- PROJECT TASK -->
    <!-- views -->

    <record id="view_task_form2" model="ir.ui.view">
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_form2"/>
        <field name="arch" type="xml">
            <field name="project_id" position="after">
                <field name="process_name" invisible="1"/>
                <field name="process_id" domain="[('project_id', '=', project_id)]"
                       context="{'form_view_ref': 'risk_management.project_process_form'}"
                       attrs="{'readonly': ['|', ('project_risk_id', '!=', False), ('business_risk_id', '!=', False)]}"
                />
                <field name="project_risk_id" readonly="1"
                       attrs="{'invisible': ['|', ('process_name', '!=', 'Risk Treatment'), ('business_risk_id', '!=', False)]}"
                />
                <field name="business_risk_id" readonly="1"
                       attrs="{'invisible': ['|', ('process_name', '!=', 'Risk Treatment'), ('project_risk_id', '!=', False)]}"
                />
                <field name="target_criterium"
                       attrs="{'invisible': [('process_name', '!=', 'Risk Treatment')]}"/>
                <!-- Issue #22879 with `not ilike` operator-->
            </field>
        </field>
    </record>

    <record id="view_task_search_form" model="ir.ui.view">
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_search_form"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='project']" position="after">
                <filter string="Process" name="process" context="{'group_by':'process_id'}"/>
            </xpath>
            <field name="stage_id" position="after">
                <field name="process_id" domain="[('project_id', '=', project_id)]"/>
            </field>
        </field>
    </record>

    <record model="ir.ui.view" id="view_task_kanban">
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_kanban"/>
        <field name="arch" type="xml">
            <kanban position="attributes">
                <attribute name="group_edit">false
                </attribute> <!-- FIXME: This is a hack. the `Edit Stage` menu is not loading the right form view -->
            </kanban>
            <field name="stage_id" position="after">
                <field name="process_id" context="{'form_view_ref': 'risk_management.project_process_form'}"/>
            </field>
        </field>
    </record>


    <!--    RISK INFO-->

    <record id="view_risk_search" model="ir.ui.view">
        <field name="name">risk_info.search</field>
        <field name="model">risk_management.risk.info</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="risk_category_id"/>
                <field name="subcategory"/>
                <field name="description"/>
                <field name="cause"/>
                <field name="consequence"/>
            </search>
        </field>
    </record>

    <record model="ir.actions.act_window" id="risk_management.act_risk_category_2_risks_all">
        <field name="name">Risks</field>
        <field name="res_model">risk_management.risk.info</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{'default_risk_category_id': active_id, 'search_default_risk_category_id': [active_id],
            }
        </field>
        <field name="search_view_id" ref="view_risk_search"/>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Here, you can create new Risks
            </p>
        </field>
    </record>

    <record id="act_risk_category_list" model="ir.actions.act_window">
        <field name="name">Risks Database</field>
        <field name="res_model">risk_management.risk.category</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Here, you can create new Risk Category
            </p>
        </field>
    </record>

    <record id="view_risk_list" model="ir.ui.view">
        <field name="name">risk_info.list</field>
        <field name="model">risk_management.risk.info</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="subcategory"/>
            </tree>
        </field>
    </record>
    <!-- TODO: add comment field -->

    <record id="view_risk_form" model="ir.ui.view">
        <field name="name">risk_info.form</field>
        <field name="model">risk_management.risk.info</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_left oe_title">
                        <label for="name" class="oe_edit_only"/>
                        <h3>
                            <field name="name" widget="text"/>
                        </h3>
                    </div>
                    <div class="oe_right oe_button_box" name="buttons">
                        <button name=""
                                type="action"
                                class="oe_stat_button"
                                icon="fa-hashtag">
                            <field string="Occurrences" name="business_occurrences" widget="statinfo"/>
                        </button>
                        <button name=""
                                type="action"
                                class="oe_stat_button"
                                icon="fa-hashtag">
                            <field string="Projects Occurrences" name="project_occurrences" widget="statinfo"/>
                        </button>
                    </div>
                    <group name="classification" string="Classification">
                        <field name="risk_category_id"/>
                        <field name="subcategory"/>
                    </group>
                    <notebook>
                        <page name="description_page" string="Description">
                            <field name="description" type="html"/>
                            <div class="oe_clear"/>
                        </page>
                        <page name="cause_page" string="Cause">
                            <field name="cause" type="html"/>
                            <div class="oe_clear"/>
                        </page>
                        <page name="consequence_page" string="Consequence">
                            <field name="consequence" type="html"/>
                            <div class="oe_clear"/>
                        </page>
                        <page name="help" string="Help">
                            <group>
                                <field name="control"/>
                                <field name="action"/>
                            </group>
                        </page>
                    </notebook>

                </sheet>
            </form>
        </field>
    </record>

    <record id="view_risk_category_list" model="ir.ui.view">
        <field name="name">risk_category.list</field>
        <field name="model">risk_management.risk.category</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="risk_count"></field>
            </tree>
        </field>
    </record>

    <record id="view_risk_category_form" model="ir.ui.view">
        <field name="name">risk_category.form</field>
        <field name="model">risk_management.risk.category</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_left oe_title">
                        <label for="name" class="oe_edit_only"/>
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    <div class="oe_right oe_button_box" name="buttons">
                        <button name="%(risk_management.act_risk_category_2_risks_all)d"
                                type="action"
                                class="oe_stat_button"
                                icon="fa-files-o">
                            <field string="Risks" name="risk_count" widget="statinfo"/>
                        </button>
                    </div>
                </sheet>
            </form>
        </field>

    </record>

    <menuitem id="menu_risk_category" parent="config_menu" sequence="10" action="act_risk_category_list"/>

    <menuitem id="menu_risk_database" parent="project_risk_management" action="act_risk_category_list" sequence="30"/>

</odoo>